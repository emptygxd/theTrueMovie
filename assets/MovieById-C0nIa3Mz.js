import{e as p,h as g,j as s,f as _,R as c,L as f,r as m,g as b,T as A,i as $,k as y,l as N}from"./index-Bls0foRN.js";import{A as E}from"./useScrollSlider-Dq0gEt9Y.js";import{A as a}from"./AboutBlock-C4WFLIYA.js";import{S as j}from"./StyledButton-D7Ja3p_W.js";const P="/theTrueMovie/assets/backdrop-BD2Dw3BA.png",v="/theTrueMovie/assets/poster-BtES5oI1.png",k=({movie:e})=>{var d,t;const{isLoading:l,isError:i,data:n}=p({queryKey:["movie",e.id],queryFn:()=>e!=null&&e.isSeries?g.get(`/season?movieId=${e.id}`).then(u=>u.data.docs):Promise.reject("No series found"),enabled:e==null?void 0:e.isSeries,refetchOnWindowFocus:!1}),r=n;let o;r&&(o=r.reduce((u,S)=>u+S.episodesCount,0));const h=e.isSeries?"Сериалы":"Фильмы";return l?s.jsx(_,{}):i?s.jsxs("div",{children:["Error: ",i]}):s.jsxs("div",{className:"about__container",children:[s.jsx("h2",{className:"section-header",children:"О фильме"}),s.jsxs("div",{className:"about__content",children:[s.jsx(a,{title:"Страна",valueArr:e.countries??" ",path:`/movies?type=${h}&country=`}),s.jsx(a,{title:"Жанры",valueArr:e.genres.length!==0?e.genres:" ",path:`/movies?type=${h}&genre=`}),s.jsx(a,{title:"Слоган",value:e.slogan??" ",className:e.slogan?"about__slogan":""}),e.isSeries&&s.jsxs(s.Fragment,{children:[s.jsx(a,{title:"Количество сезонов",value:(d=r[0])==null?void 0:d.number}),s.jsx(a,{title:"Количество серий",value:o}),e.totalSeriesLength&&s.jsx(a,{title:"Общая длительность",value:String(e.totalSeriesLength)})]}),!e.isSeries&&s.jsxs(s.Fragment,{children:[s.jsx(a,{title:"Бюджет",value:e.budget.value?`${e.budget.currency}${x(e.budget.value)}`:" "}),s.jsx(a,{title:"Сборы в мире",value:e.fees.world.value?`${e.fees.world.currency}${x(e.fees.world.value)}`:" "}),s.jsx(a,{title:"Сборы в России",value:(t=e.fees.russia)!=null&&t.value?`${e.fees.russia.currency}${x(e.fees.russia.value)}`:" "})]}),s.jsx(a,{title:"Рейтинг MPAA",value:e.ratingMpaa?e.ratingMpaa.toUpperCase():" ",className:`${e.ratingMpaa?"mpaa":""}`})]},e.id)]})},M=({persons:e})=>{const l=e.filter(t=>t.enProfession==="writer"),i=e.filter(t=>t.enProfession==="director"),n=e.filter(t=>t.enProfession==="producer"),r=e.filter(t=>t.enProfession==="operator"),o=e.filter(t=>t.enProfession==="composer"),h=e.filter(t=>t.enProfession==="designer"),d=e.filter(t=>t.enProfession==="editor");return s.jsxs("div",{className:"about__container",children:[s.jsx("h2",{className:"section-header",children:"Съемочная группа"}),s.jsxs("div",{className:"about__content",children:[s.jsx(a,{title:"Режисер",valueArr:i.length!==0?i:" ",path:c.PERSONS}),s.jsx(a,{title:"Сценарист",valueArr:l.length!==0?l:" ",path:c.PERSONS}),s.jsx(a,{title:"Продюсер",valueArr:n.length!==0?n:" ",path:c.PERSONS}),s.jsx(a,{title:"Оператор",valueArr:r.length!==0?r:" ",path:c.PERSONS}),s.jsx(a,{title:"Композитор",valueArr:o.length!==0?o:" ",path:c.PERSONS}),s.jsx(a,{title:"Дизайнер",valueArr:h.length!==0?h:" ",path:c.PERSONS}),s.jsx(a,{title:"Монтаж",valueArr:d.length!==0?d:" ",path:c.PERSONS})]})]})},O=({actor:e})=>s.jsxs(f,{to:`${c.BASE}persons/${e.id}`,className:"actor",children:[s.jsx("img",{className:"actor__photo",loading:"lazy",src:e.photo,alt:"photo"}),s.jsxs("div",{className:"actor__info",children:[s.jsx("h3",{className:"actor__name",children:e.name?e.name:e.enName}),e.description&&s.jsx("h4",{title:e.description,className:"actor__description",children:e.description})]})]}),R=({movie:e})=>{var d;const[l,i]=m.useState(!1),n=()=>{i(t=>(t?$():y(),!t))},r=Math.floor(e.movieLength/60),o=e.movieLength%60,h=()=>w("content");return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"movie__header",children:s.jsxs("div",{children:[s.jsx("img",{src:e.poster.url??v,alt:"poster",className:"movie__poster"}),s.jsxs("div",{className:"movie__info",children:[!e.isSeries&&s.jsxs("h1",{className:"movie__title",children:[e.name," ",e.year?`(${e.year})`:""]}),e.isSeries&&s.jsxs("h1",{className:"movie__title",children:[e.name," (",`${e.releaseYears[0].start}-${e.releaseYears[0].end}`,")"]}),s.jsxs("div",{className:"movie__main-info",children:[e.alternativeName&&e.ageRating&&s.jsxs("p",{className:"movie__alt-name",children:[e.alternativeName," ",e.ageRating,"+"]}),!e.isSeries&&s.jsx("p",{children:`${r} ч. ${o} мин.`}),e.isSeries&&s.jsx("p",{children:`${e.seriesLength} мин.`}),s.jsx(b,{rating:e.rating.kp})]}),s.jsx("h4",{className:"movie__plot",children:e.shortDescription}),s.jsxs("div",{className:"movie__buttons",children:[s.jsx(j,{callback:h,children:"Подробнее"}),e.videos.trailers[0]&&s.jsx(j,{callback:n,children:"Трейлер"})]})]})]})}),s.jsx("img",{src:e.backdrop.url??P,alt:"backdrop",className:"movie__backdrop"}),s.jsx(A,{url:(d=e.videos.trailers[0])==null?void 0:d.url,isOpen:l,closeModal:n})]})};function x(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}const w=e=>{{const l=document.getElementById(e);l&&l.scrollIntoView({block:"start",behavior:"smooth"})}},I=({persons:e})=>{const{movieId:l}=N(),i=e.filter(n=>n.enProfession==="actor");return s.jsxs("div",{className:"actors",children:[s.jsxs("div",{className:"actors__details",children:[s.jsx("h2",{className:"section-header",children:"В главных ролях"}),s.jsx(f,{to:`${c.MOVIES}/${l}/${c.CAST}`,children:"Полный список"})]}),s.jsx("div",{className:"actors__wrapper",children:s.jsx("div",{className:"actors__container",children:i.map((n,r)=>s.jsx(O,{actor:n},`${n}_${r}`))})}),s.jsx(E,{container:".actors__container"})]})},q=()=>{const{movieId:e}=N(),{isLoading:l,isError:i,data:n}=p({queryKey:["movie"],queryFn:()=>g.get(`/movie/${e}`),select:o=>o.data,refetchOnWindowFocus:!1}),r=n;return m.useEffect(()=>{r&&(document.title=r.name??r.enName)},[r]),l?s.jsx(_,{}):i?s.jsx("section",{children:"Error"}):s.jsx(s.Fragment,{children:s.jsxs("section",{className:"movie",children:[s.jsx(R,{movie:r}),s.jsxs("div",{id:"content",className:"movie__content",children:[s.jsxs("div",{className:"content__plot",children:[s.jsx("h2",{className:"section-header",children:"Сюжет"}),s.jsx("h3",{children:r.description})]}),s.jsxs("div",{className:"content__about",children:[s.jsx(k,{movie:r}),s.jsx(M,{persons:r.persons})]}),s.jsx(I,{persons:r.persons})]})]},r.id)})};export{q as default};
