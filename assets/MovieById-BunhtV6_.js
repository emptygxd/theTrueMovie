import{b as p,h as g,j as s,c as _,R as l,L as f,d as S,e as m,r as b}from"./index-Vln5owk7.js";import{A}from"./useScrollSlider-4OHl8CZv.js";import{A as t}from"./AboutBlock-CEJLv0dG.js";import{S as j}from"./StyledButton-BUMVW4Te.js";function x(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}const $=e=>{{const n=document.getElementById(e);n&&n.scrollIntoView({block:"start",behavior:"smooth"})}},y=({movie:e})=>{var h,a;const{isLoading:n,isError:c,data:i}=p({queryKey:["movie",e.id],queryFn:()=>e!=null&&e.isSeries?g.get(`/season?movieId=${e.id}`).then(u=>u.data.docs):Promise.reject("No series found"),enabled:e==null?void 0:e.isSeries,refetchOnWindowFocus:!1}),r=i;let o;r&&(o=r.reduce((u,N)=>u+N.episodesCount,0));const d=e.isSeries?"Сериалы":"Фильмы";return n?s.jsx(_,{}):c?s.jsxs("div",{children:["Error: ",c]}):s.jsxs("div",{className:"about__container",children:[s.jsx("h2",{className:"section-header",children:"О фильме"}),s.jsxs("div",{className:"about__content",children:[s.jsx(t,{title:"Страна",valueArr:e.countries??" ",path:`/movies?type=${d}&country=`}),s.jsx(t,{title:"Жанры",valueArr:e.genres.length!==0?e.genres:" ",path:`/movies?type=${d}&genre=`}),s.jsx(t,{title:"Слоган",value:e.slogan??" ",className:e.slogan?"about__slogan":""}),e.isSeries&&s.jsxs(s.Fragment,{children:[s.jsx(t,{title:"Количество сезонов",value:(h=r[0])==null?void 0:h.number}),s.jsx(t,{title:"Количество серий",value:o}),e.totalSeriesLength&&s.jsx(t,{title:"Общая длительность",value:String(e.totalSeriesLength)})]}),!e.isSeries&&s.jsxs(s.Fragment,{children:[s.jsx(t,{title:"Бюджет",value:e.budget.value?`${e.budget.currency}${x(e.budget.value)}`:" "}),s.jsx(t,{title:"Сборы в мире",value:e.fees.world.value?`${e.fees.world.currency}${x(e.fees.world.value)}`:" "}),s.jsx(t,{title:"Сборы в России",value:(a=e.fees.russia)!=null&&a.value?`${e.fees.russia.currency}${x(e.fees.russia.value)}`:" "})]}),s.jsx(t,{title:"Рейтинг MPAA",value:e.ratingMpaa?e.ratingMpaa.toUpperCase():" ",className:`${e.ratingMpaa?"mpaa":""}`})]},e.id)]})},v=({persons:e})=>{const n=e.filter(a=>a.enProfession==="writer"),c=e.filter(a=>a.enProfession==="director"),i=e.filter(a=>a.enProfession==="producer"),r=e.filter(a=>a.enProfession==="operator"),o=e.filter(a=>a.enProfession==="composer"),d=e.filter(a=>a.enProfession==="designer"),h=e.filter(a=>a.enProfession==="editor");return s.jsxs("div",{className:"about__container",children:[s.jsx("h2",{className:"section-header",children:"Съемочная группа"}),s.jsxs("div",{className:"about__content",children:[s.jsx(t,{title:"Режисер",valueArr:c.length!==0?c:" ",path:l.PERSONS}),s.jsx(t,{title:"Сценарист",valueArr:n.length!==0?n:" ",path:l.PERSONS}),s.jsx(t,{title:"Продюсер",valueArr:i.length!==0?i:" ",path:l.PERSONS}),s.jsx(t,{title:"Оператор",valueArr:r.length!==0?r:" ",path:l.PERSONS}),s.jsx(t,{title:"Композитор",valueArr:o.length!==0?o:" ",path:l.PERSONS}),s.jsx(t,{title:"Дизайнер",valueArr:d.length!==0?d:" ",path:l.PERSONS}),s.jsx(t,{title:"Монтаж",valueArr:h.length!==0?h:" ",path:l.PERSONS})]})]})},E=({actor:e})=>s.jsxs(f,{to:`/persons/${e.id}`,className:"actor",children:[s.jsx("img",{className:"actor__photo",loading:"lazy",src:e.photo,alt:"photo"}),s.jsxs("div",{className:"actor__info",children:[s.jsx("h3",{className:"actor__name",children:e.name?e.name:e.enName}),e.description&&s.jsx("h4",{title:e.description,className:"actor__description",children:e.description})]})]}),P="/theTrueMovie/assets/backdrop-BD2Dw3BA.png",R="/theTrueMovie/assets/poster-BtES5oI1.png",k=({movie:e})=>{const n=Math.floor(e.movieLength/60),c=e.movieLength%60,i=()=>$("content");return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"movie__header",children:s.jsxs("div",{children:[s.jsx("img",{src:e.poster.url??R,alt:"poster",className:"movie__poster"}),s.jsxs("div",{className:"movie__info",children:[!e.isSeries&&s.jsxs("h1",{className:"movie__title",children:[e.name," ",e.year?`(${e.year})`:""]}),e.isSeries&&s.jsxs("h1",{className:"movie__title",children:[e.name," (",`${e.releaseYears[0].start}-${e.releaseYears[0].end}`,")"]}),s.jsxs("div",{className:"movie__main-info",children:[e.alternativeName&&e.ageRating&&s.jsxs("p",{className:"movie__alt-name",children:[e.alternativeName," ",e.ageRating,"+"]}),!e.isSeries&&s.jsx("p",{children:`${n} ч. ${c} мин.`}),e.isSeries&&s.jsx("p",{children:`${e.seriesLength} мин.`}),s.jsx(S,{rating:e.rating.kp})]}),s.jsx("h4",{className:"movie__plot",children:e.shortDescription}),s.jsxs("div",{className:"movie__buttons",children:[s.jsx(j,{callback:i,children:"Подробнее"}),s.jsx(j,{children:"Трейлер"})]})]})]})}),s.jsx("img",{src:e.backdrop.url??P,alt:"backdrop",className:"movie__backdrop"})]})},M=({persons:e})=>{const{movieId:n}=m(),c=e.filter(i=>i.enProfession==="actor");return s.jsxs("div",{className:"actors",children:[s.jsxs("div",{className:"actors__details",children:[s.jsx("h2",{className:"section-header",children:"В главных ролях"}),s.jsx(f,{to:`${l.MOVIES}/${n}/${l.CAST}`,children:"Полный список"})]}),s.jsx("div",{className:"actors__wrapper",children:s.jsx("div",{className:"actors__container",children:c.map((i,r)=>s.jsx(E,{actor:i},r))})}),s.jsx(A,{container:".actors__container"})]})},F=()=>{const{movieId:e}=m(),{isLoading:n,isError:c,data:i}=p({queryKey:["movie"],queryFn:()=>g.get(`/movie/${e}`),select:o=>o.data,refetchOnWindowFocus:!1}),r=i;return b.useEffect(()=>{r&&(document.title=r.name??r.enName)},[r]),n?s.jsx(_,{}):c?s.jsx("section",{children:"Error"}):s.jsx(s.Fragment,{children:s.jsxs("section",{className:"movie",children:[s.jsx(k,{movie:r}),s.jsxs("div",{id:"content",className:"movie__content",children:[s.jsxs("div",{className:"content__plot",children:[s.jsx("h2",{className:"section-header",children:"Сюжет"}),s.jsx("h3",{children:r.description})]}),s.jsxs("div",{className:"content__about",children:[s.jsx(y,{movie:r}),s.jsx(v,{persons:r.persons})]}),s.jsx(M,{persons:r.persons})]})]},r.id)})};export{F as default};
